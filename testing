import sys
import urllib
import urlparse
# Regex
import re

# HTTP operations
import urllib2
import pprint

# Types, to check if variable is of type
import types


# Gets film informations
#
# Returns array with following informations:
# Array:
# [0] - Imageurl
# [1] - Title
# [2] - Url to film
# [3] - Quality
# [4] - Positive
# [5] - Positive
def getfilminformations(url):
    # Open url
    response = urllib.urlopen(url)
    html = response.read()
    # First regex to filter image and title
    # Broke into two strings because Python sucks!
    teststring = '(?:<span class="main-sliders-popup">.*\n.*\n.*\n.*\n.*<b>(.*)<\/b>.*\n.*\n.*\n.*\n.*\n.*)?'
    teststring = teststring + '<span class="main-sliders-bg">.*\n.*<a href="(.*\.html)".*\n.*\n.*<img src="(.*)" alt="(.*)">'
    teststring = teststring + '(?:.*\n.*\n.*\n.*\n.*\n.*\n.*\n.*\n.*\n(.*).*\n.*\n.*\n.*\n.*\n.*\n.*\n.*\n(.*))?'
    p = re.compile(teststring)
    UrlsImagesTitles = re.findall(p, html)

    # Create an array and write all found elements to it
    retarr = []
    for (Quality, Url, Image, Title, Positive, Negative) in UrlsImagesTitles:

        if not 'http' in Image:
            tmpImage = "http://kinokong.net" + Image
            Image = tmpImage

        # Append it to retarr
        tmpArray = []
        tmpArray.append(Image)
        tmpArray.append(Title)
        tmpArray.append(Url)
        tmpArray.append(Quality)
        tmpArray.append(Positive.strip())
        tmpArray.append(Negative.strip())
        retarr.append(tmpArray)

    return retarr

print(getfilminformations('http://kinokong.net/serial'))